<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>台指期複利試算（新版 UI）</title>

    <!-- Style -->
    <link rel="stylesheet" href="style.css" />
</head>
<body>

<div class="container">

    <h1>台指期複利試算（自選合約、自動最佳化）</h1>

    <!-- 外層設定開關 -->
    <div id="outerToggleHeader" class="outer-toggle-header collapsed">
        條件設定 <span class="toggle-icon">▼</span>
    </div>

    <div id="outerToggleContent" class="outer-toggle-content collapsed">

        <!-- 區塊 1 -->
        <div class="input-block">
            <h3 class="inner-toggle-header collapsed">
                1. 資金與成本設定 <span class="toggle-icon">▼</span>
            </h3>

            <div class="input-content collapsed">

                <div class="form-group">
                    <label>初始本金 (NT$)</label>
                    <div class="input-wrapper">
                        <input type="text" id="initialCapital" inputmode="numeric" pattern="[0-9]*" value="56000">
                        <span class="clear-btn" onclick="clearInput('initialCapital')">✕</span>
                    </div>
                </div>

                <div class="form-group">
                    <label>假設指數點位</label>
                    <div class="input-wrapper">
                        <input type="text" id="assumedIndex" inputmode="numeric" pattern="[0-9]*" value="27740">
                        <span class="clear-btn" onclick="clearInput('assumedIndex')">✕</span>
                    </div>
                </div>

                <!-- 大台 -->
                <div class="sub-group">
                    <div class="sub-group-title">【大台 - 每點$200】</div>

                    <div class="form-group">
                        <label>原始保證金</label>
                        <div class="input-wrapper">
                            <input type="text" id="bigMargin" inputmode="numeric" value="338000">
                            <span class="clear-btn" onclick="clearInput('bigMargin')">✕</span>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>來回手續費</label>
                        <div class="input-wrapper">
                            <input type="text" id="bigComm" inputmode="numeric" value="80">
                            <span class="clear-btn" onclick="clearInput('bigComm')">✕</span>
                        </div>
                    </div>
                </div>

                <!-- 小台 -->
                <div class="sub-group">
                    <div class="sub-group-title">【小台 - 每點$50】</div>

                    <div class="form-group">
                        <label>原始保證金</label>
                        <div class="input-wrapper">
                            <input type="text" id="miniMargin" inputmode="numeric" value="84500">
                            <span class="clear-btn" onclick="clearInput('miniMargin')">✕</span>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>來回手續費</label>
                        <div class="input-wrapper">
                            <input type="text" id="miniComm" inputmode="numeric" value="40">
                            <span class="clear-btn" onclick="clearInput('miniComm')">✕</span>
                        </div>
                    </div>
                </div>

                <!-- 微台 -->
                <div class="sub-group">
                    <div class="sub-group-title">【微台 - 每點$10】</div>

                    <div class="form-group">
                        <label>原始保證金</label>
                        <div class="input-wrapper">
                            <input type="text" id="microMargin" inputmode="numeric" value="16900">
                            <span class="clear-btn" onclick="clearInput('microMargin')">✕</span>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>來回手續費</label>
                        <div class="input-wrapper">
                            <input type="text" id="microComm" inputmode="numeric" value="36">
                            <span class="clear-btn" onclick="clearInput('microComm')">✕</span>
                        </div>
                    </div>
                </div>

            </div>
        </div>

        <!-- 區塊 2 -->
        <div class="input-block">
            <h3 class="inner-toggle-header collapsed">
                2. 交易合約選擇 <span class="toggle-icon">▼</span>
            </h3>

            <div class="input-content collapsed">
                <div class="contract-row">
                    <label class="contract-option">
                        <input type="checkbox" id="selectBig">
                        大台
                    </label>

                    <label class="contract-option">
                        <input type="checkbox" id="selectMini">
                        小台
                    </label>

                    <label class="contract-option">
                        <input type="checkbox" id="selectMicro">
                        微台
                    </label>
                </div>
            </div>
        </div>

        <!-- 區塊 3 -->
        <div class="input-block">
            <h3 class="inner-toggle-header collapsed">
                3. 獲利目標策略 <span class="toggle-icon">▼</span>
            </h3>

            <div class="input-content collapsed">
                <div class="sub-group-title">單次點數 × 次數</div>

                <div id="modeBInputs" class="mode-inputs active">
                    <div class="form-group">
                        <label>單次點數</label>
                        <div class="input-wrapper">
                            <input type="number" id="modeB_pointsPerTrade" value="70">
                            <span class="clear-btn" onclick="clearInput('modeB_pointsPerTrade')">✕</span>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>早盤次數</label>
                        <div class="input-wrapper">
                            <input type="number" id="modeB_morningTrades" value="3">
                            <span class="clear-btn" onclick="clearInput('modeB_morningTrades')">✕</span>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>夜盤次數</label>
                        <div class="input-wrapper">
                            <input type="number" id="modeB_nightTrades" value="2">
                            <span class="clear-btn" onclick="clearInput('modeB_nightTrades')">✕</span>
                        </div>
                    </div>
                </div>

            </div>
        </div>

        <!-- 區塊 4 -->
        <div class="input-block">
            <h3 class="inner-toggle-header collapsed">
                4. 試算日期設定 <span class="toggle-icon">▼</span>
            </h3>

            <div class="input-content collapsed">

                <div class="form-group">
                    <label>起始交易日 (D1)</label>
                    <div class="input-wrapper">
                        <input type="date" id="startDate">
                        <span class="clear-btn" onclick="clearInput('startDate')">✕</span>
                    </div>
                </div>

                <p class="note">
                    系統會自動跳過週末，並依照當前時間自動 Highlight 對應時段 (早/夜)
                </p>

            </div>
        </div>
    </div>

    <!-- 試算按鈕 -->
    <div class="btn-block">
        <button id="calculateBtn" onclick="startSimulation()">開始 20 日複利試算</button>
    </div>

    <!-- 結果區塊 -->
    <div id="resultSection" style="display:none;">
        <h2>試算結果報告</h2>

        <div class="summary-box">
            <div><label>初始本金</label><div id="summaryInitial"></div></div>
            <div><label>20日後本金</label><div id="summaryFinal"></div></div>
            <div><label>總獲利</label><div id="summaryProfit"></div></div>
            <div><label>總報酬率</label><div id="summaryROI"></div></div>
        </div>

        <div class="table-responsive">
            <table id="resultTable">
                <thead>
                    <tr>
                        <th>日期</th>
                        <th>期初本金</th>
                        <th>最佳建議</th>
                        <th>下單口數</th>
                        <th>本盤淨利</th>
                        <th>期末本金</th>
                        <th>目標點數</th>
                        <th>總稅金</th>
                        <th>總手續費</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>

        <p class="note">* 資料自動保存 20 天，下次開啟將自動載入與試算。</p>
    </div>

</div>

<!-- JS -->
<script src="app.js"></script>
</body>
</html>
